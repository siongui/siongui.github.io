<!DOCTYPE html>
<html lang="en">
<head><script data-ad-client="ca-pub-0436733829999264" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><meta charset="utf-8">
  <title>Lightweight Dynamic JavaScript Loader with Dependency Handling</title>
  <meta name="keywords" content="JavaScript,XMLHttpRequest"/>
  <meta name="description" content="Load JavaScript scripts dynamically with dependencies."/>
  <meta name="author" content="Siong-Ui Te"/><meta property="og:title" content="Lightweight Dynamic JavaScript Loader with Dependency Handling" /><meta property="og:image" content="http://www.javatpoint.com/images/javascript/javascript_logo.png" />
<meta property="og:description" content="Load JavaScript scripts dynamically with dependencies." /><meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="apple-touch-icon" href="/./extra/Dharma_wheel.png" />
  <link rel="manifest" href="/manifest.json" />

  <link rel="stylesheet" type="text/css" href="/./theme/css/style.css">
</head>
<body>

<div>
<nav class="nav">
  <div class="nav-left">
    <a class="nav-item" href="/">Theory and Practice</a>
  </div>

  <label for="menu-toggle" class="nav-toggle">&equiv;</label>
  <input type="checkbox" id="menu-toggle" class="is-hidden"/>

  <div class="nav-right nav-menu">
<a class="nav-item" href="/pages/about.html">About</a>
    <a class="nav-item" href="/archives.html">Archives</a>
    <a class="nav-item" href="/categories.html">Categories</a>
    <a class="nav-item" href="/tags.html">Tags</a>
    <a class="nav-item" href="/authors.html">Authors</a>
    <!--TODO: add links for Links(optional), and RSS -->

    <span class="vertical-divider"></span>

        <a class="nav-item" href="/zh/">中文</a>
        <a class="nav-item" href="/th/">ไทย</a>
  </div>
</nav><gcse:search></gcse:search><main role="main" class="article">
  <article>
    <header>
      <h1>
        <a href="/2012/07/25/lightweight-dynamic-javascript-loader-with-dependency-handling/"
           rel="bookmark"
           title="Permalink to Lightweight Dynamic JavaScript Loader with Dependency Handling">
          Lightweight Dynamic JavaScript Loader with Dependency Handling
        </a>
      </h1>
    </header>
<aside><time datetime="2015-04-03T08:08:00+08:00">
    Updated: April 03, 2015
  </time></aside>
    <aside><div class="edit-on-github"><a href="https://github.com/siongui/userpages/tree/master/content/articles/2012/07/25/lightweight-dynamic-javascript-loader-with-dependency-handling%25en.rst">Edit on Github</a></div></aside>
    <hr>

    <div class="main-content"><p>I write a lightweight dynamic <a class="reference external" href="https://www.google.com/search?q=JavaScript">JavaScript</a> loader with dependency handling, which
means it can dynamically loads <a class="reference external" href="https://www.google.com/search?q=JavaScript">JavaScript</a> files with the order you want. The
following is the source code for the dynamic <a class="reference external" href="https://www.google.com/search?q=JavaScript">JavaScript</a> loader:</p>
<figure class="github-file">
            <figcaption>
              <a href="https://github.com/siongui/userpages/blob/master/content/code/javascript-loader/dynamic.js">dynamic.js</a> |
              <a href="https://github.com/siongui/userpages">repository</a> |
              <a href="https://raw.githubusercontent.com/siongui/userpages/master/content/code/javascript-loader/dynamic.js">view raw</a>
            </figcaption><div class="code-file">
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span></pre></div></td><td class="code"><div><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @fileoverview Simple JavaScript Loader (with dependency handling)</span>
<span class="cm"> */</span>


<span class="cm">/**</span>
<span class="cm"> * Class to load JavaScript files according to dependency.</span>
<span class="cm"> *</span>
<span class="cm"> * @param {Array} jsNames The file names of JavaScript files to be loaded.</span>
<span class="cm"> * @param {object} jsDependencies The dependencies of JavaScript files to be</span>
<span class="cm"> *                                loaded.</span>
<span class="cm"> * @param {object} jsLocations The locations of JavaScript files to be loaded.</span>
<span class="cm"> * @constructor</span>
<span class="cm"> */</span>
<span class="nx">MySimpleJSLoader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">jsNames</span><span class="p">,</span><span class="w"> </span><span class="nx">jsDependencies</span><span class="p">,</span><span class="w"> </span><span class="nx">jsLocations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// check data sanity</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">jsNames</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;[object Array]&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="s2">&quot;In MySimpleJSLoader constructor: jsNames is not Array&quot;</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">jsDependencies</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="s2">&quot;In MySimpleJSLoader constructor: jsDependencies is not object&quot;</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">jsDependencies</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="s2">&quot;In MySimpleJSLoader constructor: jsLocations is not object&quot;</span><span class="p">;</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">jsNames</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">jsDependencies</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">jsNames</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="s2">&quot;In MySimpleJSLoader constructor: no dependency info of &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">            </span><span class="nx">jsNames</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">jsLocations</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">jsNames</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="s2">&quot;In MySimpleJSLoader constructor: no location info of &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">            </span><span class="nx">jsNames</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * The dependencies of JavaScript files to be loaded.</span>
<span class="cm">   * @const</span>
<span class="cm">   * @type {object}</span>
<span class="cm">   * @private</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">jsDependencies_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">jsDependencies</span><span class="p">;</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Indicate if the JavaScript file is loaded.</span>
<span class="cm">   * @type {object}</span>
<span class="cm">   * @private</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">isLoaded_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Contains the content of the JavaScript file</span>
<span class="cm">   * @type {object}</span>
<span class="cm">   * @private</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">jsContent_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Indicate if the content of JavaScript file is loaded.</span>
<span class="cm">   * @type {object}</span>
<span class="cm">   * @private</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">isJSContentDownloaded_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>

<span class="w">  </span><span class="c1">// initialize internal private variable</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">jsNames</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">isLoaded_</span><span class="p">[</span><span class="w"> </span><span class="nx">jsNames</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">jsContent_</span><span class="p">[</span><span class="w"> </span><span class="nx">jsNames</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">isJSContentDownloaded_</span><span class="p">[</span><span class="w"> </span><span class="nx">jsNames</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Load all JavaScript files</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">jsNames</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">loadJSFile</span><span class="p">(</span><span class="nx">jsNames</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="w"> </span><span class="nx">jsLocations</span><span class="p">[</span><span class="w"> </span><span class="nx">jsNames</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="p">]);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>


<span class="cm">/**</span>
<span class="cm"> * Load one JavaScript file by XMLHttpRequest.</span>
<span class="cm"> * @param {string} jsName The name of the JavaScript file to be loaded.</span>
<span class="cm"> * @param {string} jsLocation The location of the JavaScript file to be loaded.</span>
<span class="cm"> * @private</span>
<span class="cm"> */</span>
<span class="nx">MySimpleJSLoader</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">loadJSFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">jsName</span><span class="p">,</span><span class="w"> </span><span class="nx">jsLocation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * XMLHttpRequest variable.</span>
<span class="cm">   * @type {object}</span>
<span class="cm">   * @private</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">xmlhttp</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">xmlhttp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">XMLHttpRequest</span><span class="p">();</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">xmlhttp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">&quot;Microsoft.XMLHTTP&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>

<span class="w">  </span><span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">onreadystatechange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">jsName</span><span class="p">,</span><span class="w"> </span><span class="nx">jsLocation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">readyState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// The content of the JavaScript file is downloaded.</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">jsContent_</span><span class="p">[</span><span class="nx">jsName</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">isJSContentDownloaded_</span><span class="p">[</span><span class="nx">jsName</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">isDependencySatisfied</span><span class="p">(</span><span class="nx">jsName</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">this</span><span class="p">.</span><span class="nx">insertJS</span><span class="p">(</span><span class="nx">jsName</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// fail to get the content of the JavaScript file</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="s1">&#39;cannot load file &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">jsName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; at &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">jsLocation</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="nx">jsName</span><span class="p">,</span><span class="w"> </span><span class="nx">jsLocation</span><span class="p">);</span>

<span class="w">  </span><span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">jsLocation</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">  </span><span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
<span class="p">};</span>


<span class="cm">/**</span>
<span class="cm"> * Check if the dependency of the JavaScript file is satisfied.</span>
<span class="cm"> * @param {string} jsName The name of the JavaScript file to be checked.</span>
<span class="cm"> * @private</span>
<span class="cm"> */</span>
<span class="nx">MySimpleJSLoader</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">isDependencySatisfied</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">jsName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">jsDependencies_</span><span class="p">[</span><span class="nx">jsName</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">jsName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; has no dependency.&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">jsName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; dependency satisfied? true&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * The JavaScript files that the JavaScript file with jsName is dependent on.</span>
<span class="cm">   * @type {Array}</span>
<span class="cm">   * @private</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">dependentJSFiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">jsDependencies_</span><span class="p">[</span><span class="nx">jsName</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">dependentJSFiles</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Remove whitespace in the beginning and end of the string</span>
<span class="w">    </span><span class="nx">dependentJSFiles</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">dependentJSFiles</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(^\s+)|(\s+$)/g</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">jsName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; depends on :&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">dependentJSFiles</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">dependentJSFiles</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Indicate whether all dependencies is satisfied.</span>
<span class="cm">   * @type {boolean}</span>
<span class="cm">   * @private</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">isAllDependenciesSatisfied</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">dependentJSFiles</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isLoaded_</span><span class="p">[</span><span class="nx">dependentJSFiles</span><span class="p">[</span><span class="nx">i</span><span class="p">]])</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">isAllDependenciesSatisfied</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isAllDependenciesSatisfied</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">jsName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; dependency satisfied? true&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">jsName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; dependency satisfied? false&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">isAllDependenciesSatisfied</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/**</span>
<span class="cm"> * Insert the JavaScript file to document.</span>
<span class="cm"> * @param {string} jsName The name of the JavaScript file to be inserted.</span>
<span class="cm"> * @private</span>
<span class="cm"> */</span>
<span class="nx">MySimpleJSLoader</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">insertJS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">jsName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * DOM element of HTML script tag</span>
<span class="cm">   * @type {DOM Element}</span>
<span class="cm">   * @private</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">script</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;text/javascript&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * The content of the JavaScript file</span>
<span class="cm">   * @type {DOM Element}</span>
<span class="cm">   * @private</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">textNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">jsContent_</span><span class="p">[</span><span class="nx">jsName</span><span class="p">]</span><span class="w"> </span><span class="p">);</span>
<span class="w">  </span><span class="nx">script</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">textNode</span><span class="p">);</span>
<span class="w">  </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;head&quot;</span><span class="p">)[</span><span class="mf">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>

<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">isLoaded_</span><span class="p">[</span><span class="nx">jsName</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>

<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">jsName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; loaded&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Load other JavaScript files dependent on this inserted JavaScript file.</span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">checkAfterInsertion</span><span class="p">();</span>
<span class="p">};</span>


<span class="cm">/**</span>
<span class="cm"> * When a JavaScript is inserted to the docuement, dependencies of other</span>
<span class="cm"> * JavaScript files may be satisfied after the insertion. As a result, we need</span>
<span class="cm"> * to check dependencies of all JavaScript files after insertion.</span>
<span class="cm"> * @private</span>
<span class="cm"> */</span>
<span class="nx">MySimpleJSLoader</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">checkAfterInsertion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">jsName</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">isLoaded_</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isLoaded_</span><span class="p">[</span><span class="nx">jsName</span><span class="p">]</span>
<span class="w">        </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">isJSContentDownloaded_</span><span class="p">[</span><span class="nx">jsName</span><span class="p">]</span>
<span class="w">        </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">isDependencySatisfied</span><span class="p">(</span><span class="nx">jsName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">insertJS</span><span class="p">(</span><span class="nx">jsName</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>
</pre></div></td></tr></table></div>
</div></figure>
<div class="section" id="usage">
<h2>Usage</h2>
<p>I will show how to use the <a class="reference external" href="https://www.google.com/search?q=JavaScript">JavaScript</a> loader by example.</p>
<p>Assume that we need to load <em>a.js</em>, <em>b.js</em>, <em>c.js</em>, <em>d.js</em>.</p>
<p>They are located at <em>http://example.com/static/js/</em>.</p>
<p><em>a.js</em> has no dependency.</p>
<p><em>b.js</em> has to be loaded after <em>a.js</em> is loaded.</p>
<p><em>c.js</em> has to be loaded after <em>a.js</em> is loaded.</p>
<p><em>d.js</em> has to be loaded after <em>b.js</em> and <em>c.js</em> are loaded.</p>
<p>The following is the usage code for above example:</p>

<figure class="github-file">
            <figcaption>
              <a href="https://github.com/siongui/userpages/blob/master/content/code/javascript-loader/usage.js">usage.js</a> |
              <a href="https://github.com/siongui/userpages">repository</a> |
              <a href="https://raw.githubusercontent.com/siongui/userpages/master/content/code/javascript-loader/usage.js">view raw</a>
            </figcaption><div class="code-file">
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><span class="cm">/**</span>
<span class="cm"> * The file names of JavaScript files to be loaded</span>
<span class="cm"> */</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">jsNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;a.js&#39;</span><span class="p">,</span>
<span class="w">               </span><span class="s1">&#39;b.js&#39;</span><span class="p">,</span>
<span class="w">               </span><span class="s1">&#39;c.js&#39;</span><span class="p">,</span>
<span class="w">               </span><span class="s1">&#39;d.js&#39;</span><span class="p">];</span>

<span class="cm">/**</span>
<span class="cm"> * A JavaScript file A is dependent on a JavaScript file B if B must be loaded</span>
<span class="cm"> * before A is loaded. To describe the dependencies, use:</span>
<span class="cm"> *</span>
<span class="cm"> * &#39;file name of A&#39; : &#39;file name of B&#39;</span>
<span class="cm"> *</span>
<span class="cm"> * If a JavaScript file A is not dependent on other JavaScript, use:</span>
<span class="cm"> *</span>
<span class="cm"> * &#39;file name of A&#39; : null</span>
<span class="cm"> *</span>
<span class="cm"> * If a JavaScript file is dependent on multiple JavaScript files, the</span>
<span class="cm"> * multiple files is separated by comma.</span>
<span class="cm"> */</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">jsDependencies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="s1">&#39;a.js&#39;</span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;b.js&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;a.js&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;c.js&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;a.js&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;d.js&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;b.js, c.js&#39;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * The locations of JavaScript files, usually are URLs</span>
<span class="cm"> */</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">jsLocations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="s1">&#39;a.js&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;http://example.com/static/js/a.js&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;b.js&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;http://example.com/static/js/b.js&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;c.js&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;http://example.com/static/js/c.js&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;d.js&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;http://example.com/static/js/d.js&#39;</span>
<span class="p">};</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">myloader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MySimpleJSLoader</span><span class="p">(</span><span class="nx">jsNames</span><span class="p">,</span><span class="w"> </span><span class="nx">jsDependencies</span><span class="p">,</span><span class="w"> </span><span class="nx">jsLocations</span><span class="p">);</span>
</pre></div></td></tr></table></div>
</div></figure><p>Enjoy!</p>
</div>
</div>

    <footer><hr><address><b>Author</b>:
    <a rel="author"
       href="/author/siong-ui-te.html">Siong-Ui Te</a>
  </address><aside>
    <i>&isin;</i> <b>Category</b>:
    <a href="/category/javascript.html">JavaScript</a>
  </aside><aside>
    <i>&sum;</i> <b>Tags</b>:
      <a href="/tag/javascript.html">JavaScript</a>
,       <a href="/tag/xmlhttprequest.html">XMLHttpRequest</a>
  </aside></footer>
  </article>
</main>
</div>
<div class="layout-footer">Powered by
  <a href="https://pages.github.com/">Github Pages</a>,
  <a href="http://blog.getpelican.com/">Pelican</a>,
  <a href="https://github.com/Kronuz/pyScss">pyScss</a>.
</div>
<script>
  (function() {
    var cx = '000759460633137666077:43yuu4nvb0c';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-31712770-3', 'auto');
  ga('send', 'pageview');

</script><script>
navigator.serviceWorker && navigator.serviceWorker.register('/sw.js').then(function(registration) {
  console.log('Excellent, registered with scope: ', registration.scope);
});
</script></body>
</html>